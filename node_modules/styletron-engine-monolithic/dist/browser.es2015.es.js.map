{"version":3,"file":"browser.es2015.es.js","sources":["../src/client/sheet.js","../src/hyphenate-style-name.js","../src/validate-no-mixed-hand.js","../src/inject-style-prefixed.js","../src/validate-keyframes-object.js","../src/generate-alphabetic-name.js","../src/hash.js","../src/css.js","../src/client/client.js","../src/server/server.js"],"sourcesContent":["// @flow\n/* eslint-env browser */\n/*\npretty much vendored @emotion/sheet\nBased off glamor's StyleSheet, thanks Sunil ❤️\nhigh performance StyleSheet for css-in-js systems\n- uses multiple style tags behind the scenes for millions of rules\n- uses `insertRule` for appending in production for *much* faster performance\n// usage\nimport { StyleSheet } from '@emotion/sheet'\nlet styleSheet = new StyleSheet({ container: document.head })\nstyleSheet.insert('#box { border: 1px solid red; }')\n- appends a css rule into the stylesheet\nstyleSheet.flush()\n- empties the stylesheet of all its contents\n*/\n\ndeclare var __DEV__: boolean;\n\n// $FlowFixMe\nfunction sheetForTag(tag: HTMLStyleElement): CSSStyleSheet {\n  if (tag.sheet) {\n    return tag.sheet;\n  }\n\n  // this weirdness brought to you by firefox\n  /* istanbul ignore next */\n  for (let i = 0; i < document.styleSheets.length; i++) {\n    if (document.styleSheets[i].ownerNode === tag) {\n      // $FlowFixMe\n      return document.styleSheets[i];\n    }\n  }\n}\n\nexport type Options = {\n  nonce?: string,\n  container: Element,\n  speedy?: boolean,\n};\n\nfunction createStyleElement(options: {nonce: string | void}): HTMLStyleElement {\n  const tag = document.createElement(\"style\");\n  if (typeof options.nonce !== \"undefined\") {\n    tag.setAttribute(\"nonce\", options.nonce);\n  }\n  tag.appendChild(document.createTextNode(\"\"));\n  return tag;\n}\n\nexport class StyleSheet {\n  isSpeedy: boolean;\n  ctr: number;\n  tags: HTMLStyleElement[];\n  container: Element;\n  nonce: string | void;\n  before: Element | null;\n  constructor(options: Options) {\n    this.isSpeedy =\n      typeof options.speedy === \"undefined\" ? !__DEV__ : options.speedy;\n    this.tags = [];\n    this.ctr = 0;\n    this.nonce = options.nonce;\n    this.container = options.container;\n    this.before = null;\n  }\n  insert(rules: string[]) {\n    // the max length is how many rules we have per style tag, it's 65000 in speedy mode\n    // it's 1 in dev because we insert source maps that map a single rule to a location\n    // and you can only have one source map per style tag\n    if (this.ctr % (this.isSpeedy ? 65000 : 1) === 0) {\n      const tag = createStyleElement(this);\n      let before;\n      if (this.tags.length === 0) {\n        before = this.before;\n      } else {\n        before = this.tags[this.tags.length - 1].nextSibling;\n      }\n      this.container.insertBefore(tag, before);\n      this.tags.push(tag);\n    }\n    const tag = this.tags[this.tags.length - 1];\n\n    if (this.isSpeedy) {\n      const sheet = sheetForTag(tag);\n      rules.forEach(rule => {\n        try {\n          // this is the ultrafast version, works across browsers\n          // the big drawback is that the css won't be editable in devtools\n          sheet.insertRule(rule, sheet.cssRules.length);\n        } catch (e) {\n          if (__DEV__) {\n            // eslint-disable-next-line no-console\n            console.warn(\n              `There was a problem inserting the following rule: \"${rule}\"`,\n              e,\n            );\n          }\n        }\n      });\n    } else {\n      tag.appendChild(document.createTextNode(rules.join(\"\")));\n    }\n    this.ctr++;\n  }\n  flush() {\n    // $FlowFixMe\n    this.tags.forEach(tag => tag.parentNode.removeChild(tag));\n    this.tags = [];\n    this.ctr = 0;\n  }\n}\n","// @flow\n\nconst uppercasePattern = /[A-Z]/g;\nconst msPattern = /^ms-/;\nconst cache = {};\n\nexport default function hyphenateStyleName(prop: string): string {\n  return prop in cache\n    ? cache[prop]\n    : (cache[prop] = prop\n        .replace(uppercasePattern, \"-$&\")\n        .toLowerCase()\n        .replace(msPattern, \"-ms-\"));\n}\n","// @flow\n\n/**\n * Adapted from https://github.com/gilmoreorless/css-shorthand-properties\n */\n\nimport hyphenate from \"./hyphenate-style-name.js\";\n\nconst shorthandMap = {\n  // CSS 2.1: https://www.w3.org/TR/CSS2/propidx.html\n  \"list-style\": [\"list-style-type\", \"list-style-position\", \"list-style-image\"],\n  margin: [\"margin-top\", \"margin-right\", \"margin-bottom\", \"margin-left\"],\n  outline: [\"outline-width\", \"outline-style\", \"outline-color\"],\n  padding: [\"padding-top\", \"padding-right\", \"padding-bottom\", \"padding-left\"],\n\n  // CSS Backgrounds and Borders Module Level 3: https://www.w3.org/TR/css3-background/\n  background: [\n    \"background-image\",\n    \"background-position\",\n    \"background-size\",\n    \"background-repeat\",\n    \"background-origin\",\n    \"background-clip\",\n    \"background-attachment\",\n    \"background-color\",\n  ],\n  border: [\n    \"border-top-width\",\n    \"border-right-width\",\n    \"border-bottom-width\",\n    \"border-left-width\",\n    \"border-width\",\n    \"border-top-style\",\n    \"border-right-style\",\n    \"border-bottom-style\",\n    \"border-left-style\",\n    \"border-style\",\n    \"border-top-color\",\n    \"border-right-color\",\n    \"border-bottom-color\",\n    \"border-left-color\",\n    \"border-color\",\n  ],\n  \"border-color\": [\n    \"border-top-color\",\n    \"border-right-color\",\n    \"border-bottom-color\",\n    \"border-left-color\",\n  ],\n  \"border-style\": [\n    \"border-top-style\",\n    \"border-right-style\",\n    \"border-bottom-style\",\n    \"border-left-style\",\n  ],\n  \"border-width\": [\n    \"border-top-width\",\n    \"border-right-width\",\n    \"border-bottom-width\",\n    \"border-left-width\",\n  ],\n  \"border-top\": [\"border-top-width\", \"border-top-style\", \"border-top-color\"],\n  \"border-right\": [\n    \"border-right-width\",\n    \"border-right-style\",\n    \"border-right-color\",\n  ],\n  \"border-bottom\": [\n    \"border-bottom-width\",\n    \"border-bottom-style\",\n    \"border-bottom-color\",\n  ],\n  \"border-left\": [\n    \"border-left-width\",\n    \"border-left-style\",\n    \"border-left-color\",\n  ],\n  \"border-radius\": [\n    \"border-top-left-radius\",\n    \"border-top-right-radius\",\n    \"border-bottom-right-radius\",\n    \"border-bottom-left-radius\",\n  ],\n  \"border-image\": [\n    \"border-image-source\",\n    \"border-image-slice\",\n    \"border-image-width\",\n    \"border-image-outset\",\n    \"border-image-repeat\",\n  ],\n\n  // CSS Fonts Module Level 3: https://www.w3.org/TR/css3-fonts/\n  font: [\n    \"font-style\",\n    \"font-variant-ligatures\",\n    \"font-variant-alternates\",\n    \"font-variant-caps\",\n    \"font-variant-numeric\",\n    \"font-variant-east-asian\",\n    \"font-variant\",\n    \"font-weight\",\n    \"font-stretch\",\n    \"font-size\",\n    \"line-height\",\n    \"font-family\",\n  ],\n  \"font-variant\": [\n    \"font-variant-ligatures\",\n    \"font-variant-alternates\",\n    \"font-variant-caps\",\n    \"font-variant-numeric\",\n    \"font-variant-east-asian\",\n  ],\n\n  // CSS Flexible Box Layout Module Level 1: https://www.w3.org/TR/css3-flexbox-1/\n  flex: [\"flex-grow\", \"flex-shrink\", \"flex-basis\"],\n  \"flex-flow\": [\"flex-direction\", \"flex-wrap\"],\n\n  // CSS Grid Layout Module Level 1: https://www.w3.org/TR/css-grid-1/\n  grid: [\n    \"grid-template-rows\",\n    \"grid-template-columns\",\n    \"grid-template-areas\",\n    \"grid-auto-rows\",\n    \"grid-auto-columns\",\n    \"grid-auto-flow\",\n  ],\n  \"grid-template\": [\n    \"grid-template-rows\",\n    \"grid-template-columns\",\n    \"grid-template-areas\",\n  ],\n  \"grid-row\": [\"grid-row-start\", \"grid-row-end\"],\n  \"grid-column\": [\"grid-column-start\", \"grid-column-end\"],\n  \"grid-area\": [\n    \"grid-row-start\",\n    \"grid-column-start\",\n    \"grid-row-end\",\n    \"grid-column-end\",\n  ],\n  \"grid-gap\": [\"grid-row-gap\", \"grid-column-gap\"],\n\n  // CSS Masking Module Level 1: https://www.w3.org/TR/css-masking/\n  mask: [\n    \"mask-image\",\n    \"mask-mode\",\n    \"mask-position\",\n    \"mask-size\",\n    \"mask-repeat\",\n    \"mask-origin\",\n    \"mask-clip\",\n  ],\n  \"mask-border\": [\n    \"mask-border-source\",\n    \"mask-border-slice\",\n    \"mask-border-width\",\n    \"mask-border-outset\",\n    \"mask-border-repeat\",\n    \"mask-border-mode\",\n  ],\n\n  // CSS Multi-column Layout Module: https://www.w3.org/TR/css3-multicol/\n  columns: [\"column-width\", \"column-count\"],\n  \"column-rule\": [\n    \"column-rule-width\",\n    \"column-rule-style\",\n    \"column-rule-color\",\n  ],\n\n  // CSS Scroll Snap Module Level 1: https://www.w3.org/TR/css-scroll-snap-1/\n  \"scroll-padding\": [\n    \"scroll-padding-top\",\n    \"scroll-padding-right\",\n    \"scroll-padding-bottom\",\n    \"scroll-padding-left\",\n  ],\n  \"scroll-padding-block\": [\n    \"scroll-padding-block-start\",\n    \"scroll-padding-block-end\",\n  ],\n  \"scroll-padding-inline\": [\n    \"scroll-padding-inline-start\",\n    \"scroll-padding-inline-end\",\n  ],\n  \"scroll-snap-margin\": [\n    \"scroll-snap-margin-top\",\n    \"scroll-snap-margin-right\",\n    \"scroll-snap-margin-bottom\",\n    \"scroll-snap-margin-left\",\n  ],\n  \"scroll-snap-margin-block\": [\n    \"scroll-snap-margin-block-start\",\n    \"scroll-snap-margin-block-end\",\n  ],\n  \"scroll-snap-margin-inline\": [\n    \"scroll-snap-margin-inline-start\",\n    \"scroll-snap-margin-inline-end\",\n  ],\n\n  // CSS Speech Module: https://www.w3.org/TR/css3-speech/\n  cue: [\"cue-before\", \"cue-after\"],\n  pause: [\"pause-before\", \"pause-after\"],\n  rest: [\"rest-before\", \"rest-after\"],\n\n  // CSS Text Decoration Module Level 3: https://www.w3.org/TR/css-text-decor-3/\n  \"text-decoration\": [\n    \"text-decoration-line\",\n    \"text-decoration-style\",\n    \"text-decoration-color\",\n  ],\n  \"text-emphasis\": [\"text-emphasis-style\", \"text-emphasis-color\"],\n\n  // CSS Animations (WD): https://www.w3.org/TR/css3-animations\n  animation: [\n    \"animation-name\",\n    \"animation-duration\",\n    \"animation-timing-function\",\n    \"animation-delay\",\n    \"animation-iteration-count\",\n    \"animation-direction\",\n    \"animation-fill-mode\",\n    \"animation-play-state\",\n  ],\n\n  // CSS Transitions (WD): https://www.w3.org/TR/css3-transitions/\n  transition: [\n    \"transition-property\",\n    \"transition-duration\",\n    \"transition-timing-function\",\n    \"transition-delay\",\n  ],\n};\n\nexport function validateNoMixedHand(style: Object) {\n  const hyphenatedProperties = Object.keys(style).reduce((acc, property) => {\n    acc[hyphenate(property)] = property;\n    return acc;\n  }, {});\n\n  const mixed = [];\n  for (const property in hyphenatedProperties) {\n    if (property in shorthandMap) {\n      for (const longhand of shorthandMap[property]) {\n        if (longhand in hyphenatedProperties) {\n          const long = hyphenatedProperties[longhand];\n          const short = hyphenatedProperties[property];\n          mixed.push({\n            shorthand: {property: short, value: style[short]},\n            longhand: {property: long, value: style[long]},\n          });\n        }\n      }\n    }\n  }\n  return mixed;\n}\n","// @flow\n\ndeclare var __DEV__: boolean;\n\nimport hyphenate from \"./hyphenate-style-name.js\";\nimport {validateNoMixedHand} from \"./validate-no-mixed-hand.js\";\nimport {prefix} from \"inline-style-prefixer\";\n\nimport type {StyleObject} from \"styletron-standard\";\n\nexport default function injectStylePrefixed(\n  styles: StyleObject,\n  className: string,\n  globalPrefix: string,\n  strict: boolean,\n) {\n  const outputRules = [];\n  let plainBlock = \"\";\n  for (const originalKey in styles) {\n    const originalVal = styles[originalKey];\n    if (originalVal === void 0 || originalVal === null) {\n      continue;\n    }\n    if (typeof originalVal !== \"object\") {\n      // Non-null and non-undefined primitive value\n      if (__DEV__) {\n        validateValueType(originalVal, originalKey);\n      }\n      const propValPair = `${hyphenate(\n        originalKey,\n      )}:${((originalVal: any): string)}`;\n      const prefixed = prefix({[originalKey]: originalVal});\n      for (const prefixedKey in prefixed) {\n        const prefixedVal = prefixed[prefixedKey];\n        const prefixedValType = typeof prefixedVal;\n        if (prefixedValType === \"string\" || prefixedValType === \"number\") {\n          const prefixedPair = `${hyphenate(prefixedKey)}:${prefixedVal}`;\n          if (prefixedPair !== propValPair) {\n            plainBlock += `${prefixedPair};`;\n          }\n        } else if (Array.isArray(prefixedVal)) {\n          const hyphenated = hyphenate(prefixedKey);\n          for (let i = 0; i < prefixedVal.length; i++) {\n            const prefixedPair = `${hyphenated}:${prefixedVal[i]}`;\n            if (prefixedPair !== propValPair) {\n              plainBlock += `${prefixedPair};`;\n            }\n          }\n        }\n      }\n      plainBlock += `${propValPair};`;\n    } else if (originalKey[0] === \":\") {\n      outputRules.push(\n        `.${globalPrefix}css-${className}${originalKey}{${injectStylePrefixed(\n          originalVal,\n          \"\",\n          globalPrefix,\n          strict,\n        ).join(\"\")}}`,\n      );\n    } else if (originalKey[0] === \"@\") {\n      outputRules.push(\n        `${originalKey}{${injectStylePrefixed(\n          originalVal,\n          className,\n          globalPrefix,\n          strict,\n        ).join(\"\")}}`,\n      );\n    } else {\n      outputRules.push(\n        `${originalKey}{${injectStylePrefixed(\n          originalVal,\n          \"\",\n          globalPrefix,\n          strict,\n        ).join(\"\")}}`,\n      );\n    }\n  }\n  // strict mode checks for mixed long/shorthands to keep compatibility with atomic engine\n  if (strict && __DEV__) {\n    const conflicts = validateNoMixedHand(styles);\n    if (conflicts.length) {\n      conflicts.forEach(({shorthand, longhand}) => {\n        const short = JSON.stringify({[shorthand.property]: shorthand.value});\n        const long = JSON.stringify({[longhand.property]: longhand.value});\n        // eslint-disable-next-line no-console\n        console.warn(\n          `Styles \\`${short}\\` and \\`${long}\\` in object yielding class \"${className}\" may result in unexpected behavior. Mixing shorthand and longhand properties within the same style object is unsupported with atomic rendering.`,\n        );\n      });\n    }\n  }\n  // we are inside of a pseudo-selector\n  if (!className) {\n    return [plainBlock];\n  }\n  if (!plainBlock) {\n    return outputRules;\n  }\n  return [`.${globalPrefix}css-${className}{${plainBlock}}`, ...outputRules];\n}\n\nfunction validateValueType(value, key) {\n  if (\n    value === null ||\n    Array.isArray(value) ||\n    (typeof value !== \"number\" && typeof value !== \"string\")\n  ) {\n    throw new Error(\n      `Unsupported style value: ${JSON.stringify(\n        value,\n      )} used in property ${JSON.stringify(key)}`,\n    );\n  }\n}\n","// @flow\n\n/* eslint-disable no-console */\n\nconst validAnimationState = /^(from|to|\\+?(\\d*\\.)?\\d+%)(\\s*,\\s*(from|to|\\+?(\\d*\\.)?\\d+%))*$/;\n\nexport default function validateKeyframesObject(keyframes: Object) {\n  let valid = true;\n  for (const animationState in keyframes) {\n    const value = keyframes[animationState];\n    if (!validAnimationState.test(animationState)) {\n      valid = false;\n      console.warn(\n        `Warning: property \"${animationState}\" in keyframes object ${JSON.stringify(\n          keyframes,\n        )} is not a valid. Must be \"from\", \"to\", or a percentage.`,\n      );\n    }\n    if (typeof value !== \"object\") {\n      valid = false;\n      console.warn(\n        `Warning: value for \"${animationState}\" property in keyframes object ${JSON.stringify(\n          keyframes,\n        )} must be an object. Instead it was a ${typeof value}.`,\n      );\n    }\n    if (!valid) {\n      console.warn(\n        `Warning: object used as value for \"animationName\" style is invalid:`,\n        keyframes,\n      );\n    }\n  }\n}\n","// @flow\n// vendored in from styled-components\n\nconst AD_REPLACER_R = /(a)(d)/gi;\n\n/* This is the \"capacity\" of our alphabet i.e. 2x26 for all letters plus their capitalised\n * counterparts */\nconst charsLength = 52;\n\n/* start at 75 for 'a' until 'z' (25) and then start at 65 for capitalised letters */\nconst getAlphabeticChar = (code: number): string =>\n  String.fromCharCode(code + (code > 25 ? 39 : 97));\n\n/* input a number, usually a hash and convert it to base-52 */\nexport default function generateAlphabeticName(code: number): string {\n  let name = \"\";\n  let x;\n\n  /* get a char and divide by alphabet-length */\n  for (x = Math.abs(code); x > charsLength; x = (x / charsLength) | 0) {\n    name = getAlphabeticChar(x % charsLength) + name;\n  }\n\n  return (getAlphabeticChar(x % charsLength) + name).replace(\n    AD_REPLACER_R,\n    \"$1-$2\",\n  );\n}\n","// @flow\n// vendored in from styled-components\n\nexport const SEED = 5381 | 0;\n\n// When we have separate strings it's useful to run a progressive\n// version of djb2 where we pretend that we're still looping over\n// the same string\nexport const phash = (h: number, x: string): number => {\n  h |= 0;\n  for (let i = 0, l = x.length | 0; i < l; i++) {\n    h = (h << 5) + h + x.charCodeAt(i);\n  }\n\n  return h;\n};\n\n// This is a djb2 hashing function\nexport const hash = (x: string): number => {\n  return phash(SEED, x) >>> 0;\n};\n","// @flow\n\ndeclare var __DEV__: boolean;\n\nimport hyphenate from \"./hyphenate-style-name.js\";\nimport validateKeyframesObject from \"./validate-keyframes-object.js\";\nimport generateAlphabeticName from \"./generate-alphabetic-name\";\nimport {hash} from \"./hash\";\n\nimport type {\n  StyleObject,\n  FontFaceObject,\n  KeyframesObject,\n} from \"styletron-standard\";\n\nexport function hashCssObject(\n  cssObject: StyleObject | FontFaceObject | KeyframesObject,\n): string {\n  return generateAlphabeticName(hash(JSON.stringify(cssObject)));\n}\n\nexport function keyframesToBlock(keyframes: {[string]: Object}): string {\n  if (__DEV__) {\n    validateKeyframesObject(keyframes);\n  }\n  if (__DEV__ && typeof Object.getPrototypeOf(keyframes) !== \"undefined\") {\n    if (Object.getPrototypeOf(keyframes) !== Object.getPrototypeOf({})) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        \"Only plain objects should be used as animation values. Unexpectedly recieved:\",\n        keyframes,\n      );\n    }\n  }\n  let result = \"\";\n  for (const animationState in keyframes) {\n    result += `${animationState}{${declarationsToBlock(\n      keyframes[animationState],\n    )}}`;\n  }\n  return result;\n}\n\nexport function declarationsToBlock(style: Object): string {\n  let css = \"\";\n  for (const prop in style) {\n    const val = style[prop];\n    if (typeof val === \"string\" || typeof val === \"number\") {\n      css += `${hyphenate(prop)}:${val};`;\n    }\n  }\n  // trim trailing semicolon\n  return css.slice(0, -1);\n}\n\nexport function keyframesBlockToRule(id: string, block: string): string {\n  return `@keyframes ${id}{${block}}`;\n}\n\nexport function fontFaceBlockToRule(id: string, block: string): string {\n  return `@font-face{font-family:${id};${block}}`;\n}\n","// @flow\n\n/* eslint-env browser */\n\nimport {StyleSheet} from \"./sheet\";\n\nimport type {\n  StandardEngine,\n  KeyframesObject,\n  FontFaceObject,\n  StyleObject,\n} from \"styletron-standard\";\n\nimport injectStylePrefixed from \"../inject-style-prefixed.js\";\n\nimport {\n  keyframesBlockToRule,\n  declarationsToBlock,\n  keyframesToBlock,\n  fontFaceBlockToRule,\n  hashCssObject,\n} from \"../css.js\";\n\ndeclare var __DEV__: boolean;\n\ntype hydrateT =\n  | HTMLCollection<HTMLStyleElement>\n  | Array<HTMLStyleElement>\n  | NodeList<HTMLStyleElement>;\n\ntype optionsT = {\n  hydrate?: hydrateT,\n  container?: Element,\n  prefix?: string,\n  strict?: boolean,\n};\n\ntype cacheT = {\n  [key: string]: true,\n};\n\nclass StyletronClient implements StandardEngine {\n  container: Element;\n  opts: optionsT;\n  styleSheet: StyleSheet;\n  cache: cacheT;\n\n  constructor(opts?: optionsT = {}) {\n    this.opts = opts || {};\n    this.cache = {};\n\n    if (opts.container) {\n      this.container = opts.container;\n    }\n\n    // hydration\n    if (opts.hydrate && opts.hydrate.length > 1) {\n      if (__DEV__) {\n        // eslint-disable-next-line no-console\n        console.warn(\n          \"Client hydration expects only a single style tag from the server. Make sure your server uses styletron-engine-monolithic and not atomic.\",\n        );\n      }\n    } else if (opts.hydrate && opts.hydrate.length === 1) {\n      // infer container from parent element\n      if (!this.container) {\n        const parentElement = opts.hydrate[0].parentElement;\n        if (parentElement !== null && parentElement !== void 0) {\n          this.container = parentElement;\n        }\n      }\n      // there is a single style tag coming from the monolithic server\n      const element = opts.hydrate[0];\n      const dataHydrate = element.getAttribute(\"data-hydrate\");\n      if (dataHydrate) {\n        dataHydrate.split(\" \").forEach(hashKey => {\n          // cache keys are unique across fonts, keyframes and other css so\n          // we use a single attribute to get them all\n          this.cache[hashKey] = true;\n        });\n      }\n    }\n\n    if (!this.container) {\n      if (document.head === null) {\n        throw new Error(\"No container provided and `document.head` was null\");\n      }\n      this.container = document.head;\n    }\n\n    this.styleSheet = new StyleSheet({container: this.container});\n  }\n\n  renderStyle(styles: StyleObject): string {\n    const className = hashCssObject(styles);\n    if (!this.cache[className]) {\n      this.cache[className] = true;\n      this.styleSheet.insert(\n        injectStylePrefixed(\n          styles,\n          className,\n          this.opts.prefix || \"\",\n          Boolean(this.opts.strict),\n        ),\n      );\n    }\n    return `${this.opts.prefix || \"\"}css-${className}`;\n  }\n\n  renderFontFace(fontFace: FontFaceObject): string {\n    const fontName = hashCssObject(fontFace);\n    if (!this.cache[fontName]) {\n      this.cache[fontName] = true;\n      this.styleSheet.insert([\n        fontFaceBlockToRule(\n          `${this.opts.prefix || \"\"}font-${fontName}`,\n          declarationsToBlock(fontFace),\n        ),\n      ]);\n    }\n    return `${this.opts.prefix || \"\"}font-${fontName}`;\n  }\n\n  renderKeyframes(keyframes: KeyframesObject): string {\n    const animationName = hashCssObject(keyframes);\n    if (!this.cache[animationName]) {\n      this.cache[animationName] = true;\n      this.styleSheet.insert([\n        keyframesBlockToRule(\n          `${this.opts.prefix || \"\"}animation-${animationName}`,\n          keyframesToBlock(keyframes),\n        ),\n      ]);\n    }\n    return `${this.opts.prefix || \"\"}animation-${animationName}`;\n  }\n}\n\nexport default StyletronClient;\n","// @flow\nimport type {StandardEngine} from \"styletron-standard\";\nimport injectStylePrefixed from \"../inject-style-prefixed.js\";\n\nimport type {\n  StyleObject,\n  FontFaceObject,\n  KeyframesObject,\n} from \"styletron-standard\";\n\nimport {\n  keyframesToBlock,\n  keyframesBlockToRule,\n  fontFaceBlockToRule,\n  declarationsToBlock,\n  hashCssObject,\n} from \"../css\";\n\nexport type sheetT = {|\n  css: string,\n  attrs: {[string]: string},\n|};\n\nexport type optionsT = {\n  prefix?: string,\n  strict?: boolean,\n};\n\nexport type cacheT = {\n  [key: string]: string,\n};\n\nclass StyletronServer implements StandardEngine {\n  cache: cacheT;\n  opts: optionsT;\n\n  constructor(opts?: optionsT = {}) {\n    this.opts = opts || {};\n    this.cache = {};\n  }\n\n  renderStyle(styles: StyleObject): string {\n    const className = hashCssObject(styles);\n    if (!this.cache[className]) {\n      this.cache[className] = injectStylePrefixed(\n        styles,\n        className,\n        this.opts.prefix || \"\",\n        Boolean(this.opts.strict),\n      ).join(\"\");\n    }\n    return `${this.opts.prefix || \"\"}css-${className}`;\n  }\n\n  renderFontFace(fontFace: FontFaceObject): string {\n    const fontName = hashCssObject(fontFace);\n    if (!this.cache[fontName]) {\n      this.cache[fontName] = fontFaceBlockToRule(\n        `${this.opts.prefix || \"\"}font-${fontName}`,\n        declarationsToBlock(fontFace),\n      );\n    }\n    return `${this.opts.prefix || \"\"}font-${fontName}`;\n  }\n\n  renderKeyframes(keyframes: KeyframesObject): string {\n    const animationName = hashCssObject(keyframes);\n    if (!this.cache[animationName]) {\n      this.cache[animationName] = keyframesBlockToRule(\n        `${this.opts.prefix || \"\"}animation-${animationName}`,\n        keyframesToBlock(keyframes),\n      );\n    }\n    return `${this.opts.prefix || \"\"}animation-${animationName}`;\n  }\n\n  getStylesheets(): Array<sheetT> {\n    const hashedNames = [...Object.keys(this.cache)];\n    return [\n      {\n        css: this.getCss(),\n        attrs: {\"data-hydrate\": hashedNames.join(\" \")},\n      },\n    ];\n  }\n\n  getStylesheetsHtml(className?: string = \"_styletron_hydrate_\") {\n    return generateHtmlString(this.getStylesheets(), className);\n  }\n\n  getCss() {\n    return [...Object.values(this.cache)].join(\"\");\n  }\n}\n\nexport function generateHtmlString(sheets: Array<sheetT>, className: string) {\n  let html = \"\";\n  for (let i = 0; i < sheets.length; i++) {\n    const sheet = sheets[i];\n    const {class: originalClassName, ...rest} = sheet.attrs;\n    const attrs = {\n      class: originalClassName\n        ? `${className} ${originalClassName}`\n        : className,\n      ...rest,\n    };\n    html += `<style${attrsToString(attrs)}>${sheet.css}</style>`;\n  }\n  return html;\n}\n\nfunction attrsToString(attrs) {\n  let result = \"\";\n  for (const attr in attrs) {\n    const value = attrs[attr];\n    if (value === true) {\n      result += \" \" + attr;\n    } else if (value !== false) {\n      result += ` ${attr}=\"${value}\"`;\n    }\n  }\n  return result;\n}\n\nexport default StyletronServer;\n"],"names":["sheetForTag","tag","sheet","i","document","styleSheets","length","ownerNode","createStyleElement","options","createElement","nonce","setAttribute","appendChild","createTextNode","StyleSheet","isSpeedy","speedy","tags","ctr","container","before","rules","nextSibling","insertBefore","push","forEach","rule","insertRule","cssRules","e","warn","join","parentNode","removeChild","uppercasePattern","msPattern","cache","hyphenateStyleName","prop","replace","toLowerCase","shorthandMap","validateNoMixedHand","style","hyphenatedProperties","Object","keys","reduce","acc","property","hyphenate","mixed","longhand","long","short","injectStylePrefixed","styles","className","globalPrefix","strict","outputRules","plainBlock","originalKey","originalVal","propValPair","prefixed","prefix","prefixedKey","prefixedVal","prefixedValType","prefixedPair","Array","isArray","hyphenated","conflicts","JSON","stringify","shorthand","value","validateValueType","key","Error","validAnimationState","validateKeyframesObject","keyframes","valid","animationState","test","AD_REPLACER_R","charsLength","getAlphabeticChar","code","String","fromCharCode","generateAlphabeticName","name","x","Math","abs","SEED","phash","h","l","charCodeAt","hash","hashCssObject","cssObject","keyframesToBlock","getPrototypeOf","result","declarationsToBlock","css","val","slice","keyframesBlockToRule","id","block","fontFaceBlockToRule","StyletronClient","opts","hydrate","parentElement","element","dataHydrate","getAttribute","split","hashKey","head","styleSheet","insert","Boolean","fontFace","fontName","animationName","StyletronServer","hashedNames","getCss","generateHtmlString","getStylesheets","values","sheets","html","attrs","originalClassName","rest","attrsToString","attr"],"mappings":"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"}